<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Peaks.jl · Peaks</title><script data-outdated-warner src="assets/warner.js"></script><link rel="canonical" href="https://halleysfifthinc.github.io/Peaks.jl/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>Peaks</a></span></div><form class="docs-search" action="search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Peaks.jl</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Peaks.jl</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Peaks.jl</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/halleysfifthinc/Peaks.jl/blob/master/docs/src/index.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Peaks.jl"><a class="docs-heading-anchor" href="#Peaks.jl">Peaks.jl</a><a id="Peaks.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Peaks.jl" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="Peaks.argmaxima" href="#Peaks.argmaxima"><code>Peaks.argmaxima</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">argmaxima(x[, w=1; strict=true])</code></pre><p>Find the indices of the local maxima of <code>x</code> where each maxima <code>i</code> is either the maximum of <code>x[i-w:i+w]</code> or the first index of a plateau.</p><p>If <code>strict</code> is <code>true</code>, all elements of <code>x[i-w:i+w]</code> or the bounds of a plateau must exist and must not be <code>missing</code> or <code>NaN</code>. For <code>strict == false</code>, a maxima is the maximum or first element of all existing and non-NaN or missing elements in <code>x[i-w:i+w]</code> or the bounds of a plateau.</p><p>See also: <a href="#Peaks.findmaxima"><code>findmaxima</code></a>, <a href="#Peaks.findnextmaxima"><code>findnextmaxima</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; argmaxima([0,2,0,1,1,0])
2-element Vector{Int64}:
 2
 4

julia&gt; argmaxima([2,0,1,1])
Int64[]

julia&gt; argmaxima([2,0,1,1]; strict=false)
2-element Vector{Int64}:
 1
 3</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/halleysfifthinc/Peaks.jl/blob/2d6a4a25ac29e3f319adfb4e2ce1170ff5f5c655/src/minmax.jl#LL98-L126">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Peaks.argminima" href="#Peaks.argminima"><code>Peaks.argminima</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">argminima(x[, w=1; strict=false])</code></pre><p>Find the indices of the local minima of <code>x</code> where each minima <code>i</code> is either the minimum of <code>x[i-w:i+w]</code> or the first index of a plateau.</p><p>If <code>strict</code> is <code>true</code>, all elements of <code>x[i-w:i+w]</code> or the bounds of a plateau must exist and must not be <code>missing</code> or <code>NaN</code>. For <code>strict == false</code>, a minima is the minimum or first element of all existing and non-NaN or missing elements in <code>x[i-w:i+w]</code> or the bounds of a plateau.</p><p>See also: <a href="#Peaks.findminima"><code>findminima</code></a>, <a href="#Peaks.findnextminima"><code>findnextminima</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; argminima([3,2,3,1,1,3])
2-element Vector{Int64}:
 2
 4

julia&gt; argminima([2,3,1,1])
Int64[]

julia&gt; argminima([2,3,1,1]; strict=false)
2-element Vector{Int64}:
 1
 3</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/halleysfifthinc/Peaks.jl/blob/2d6a4a25ac29e3f319adfb4e2ce1170ff5f5c655/src/minmax.jl#LL192-L221">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Peaks.findmaxima" href="#Peaks.findmaxima"><code>Peaks.findmaxima</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">findmaxima(x[, w=1; strict=true]) -&gt; (idxs, vals)</code></pre><p>Find the indices and values of the local maxima of <code>x</code> where each maxima <code>i</code> is either the maximum of <code>x[i-w:i+w]</code> or the first index of a plateau.</p><p>See also: <a href="#Peaks.argmaxima"><code>argmaxima</code></a>, <a href="#Peaks.findnextmaxima"><code>findnextmaxima</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/halleysfifthinc/Peaks.jl/blob/2d6a4a25ac29e3f319adfb4e2ce1170ff5f5c655/src/minmax.jl#LL148-L155">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Peaks.findminima" href="#Peaks.findminima"><code>Peaks.findminima</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">findminima(x[, w=1; strict=true]) -&gt; (idxs, vals)</code></pre><p>Find the indices and values of the local minima of <code>x</code> where each minima <code>i</code> is either the minimum of <code>x[i-w:i+w]</code> or the first index of a plateau.</p><p>See also: <a href="#Peaks.argminima"><code>argminima</code></a>, <a href="#Peaks.findnextminima"><code>findnextminima</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/halleysfifthinc/Peaks.jl/blob/2d6a4a25ac29e3f319adfb4e2ce1170ff5f5c655/src/minmax.jl#LL243-L250">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Peaks.peakproms" href="#Peaks.peakproms"><code>Peaks.peakproms</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">peakproms(peaks, x;
    strict=true,
    minprom=nothing,
    maxprom=nothing
) -&gt; (peaks, proms)</code></pre><p>Calculate the prominences of <code>peaks</code> in <code>x</code>, filtering peaks with prominences less than <code>minprom</code> and greater than <code>maxprom</code>, if either are given.</p><p>Peak prominence is the absolute height difference between the current peak and the larger of the two adjacent smallest magnitude points between the current peak and adjacent larger peaks or signal ends.</p><p>The prominence for a peak with a <code>NaN</code> or <code>missing</code> between the current peak and either adjacent larger peaks will be <code>NaN</code> or <code>missing</code> if <code>strict == true</code>, or it will be the larger of the smallest non-<code>NaN</code> or <code>missing</code> values between the current peak and adjacent larger peaks for <code>strict == false</code>.</p><p>See also: <a href="#Peaks.findminima"><code>findminima</code></a>, <a href="#Peaks.findmaxima"><code>findmaxima</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; x = [0,5,2,3,3,1,4,0];

julia&gt; xpks = argmaxima(x)
3-element Vector{Int64}:
 2
 4
 7

julia&gt; peakproms(xpks, x)
([2, 4, 7], Union{Missing, Int64}[5, 1, 3])

julia&gt; x = [missing,5,2,3,3,1,4,0];

julia&gt; peakproms(xpks, x)
([2, 4, 7], Union{Missing, Int64}[missing, 1, 3])

julia&gt; peakproms(xpks, x; strict=false)
([2, 4, 7], Union{Missing, Int64}[5, 1, 3])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/halleysfifthinc/Peaks.jl/blob/2d6a4a25ac29e3f319adfb4e2ce1170ff5f5c655/src/peakprom.jl#LL1-L43">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Peaks.peakproms!" href="#Peaks.peakproms!"><code>Peaks.peakproms!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">peakproms!(peaks, x;
    strict=true,
    minprom=nothing,
    maxprom=nothing
) -&gt; (peaks, proms)</code></pre><p>Calculate the prominences of <code>peaks</code> in <code>x</code>, removing <code>peaks</code> with prominences less than <code>minprom</code> or greater than <code>maxprom</code>, if either are given. Returns the modified peaks and their prominences.</p><p>See also: <a href="#Peaks.peakproms"><code>peakproms</code></a>, <a href="#Peaks.findminima"><code>findminima</code></a>, <a href="#Peaks.findmaxima"><code>findmaxima</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/halleysfifthinc/Peaks.jl/blob/2d6a4a25ac29e3f319adfb4e2ce1170ff5f5c655/src/peakprom.jl#LL61-L73">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Peaks.peakwidths" href="#Peaks.peakwidths"><code>Peaks.peakwidths</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">peakwidths(peaks, x, proms;
    strict=true,
    relheight=0.5,
    minwidth=nothing,
    maxwidth=nothing
) -&gt; (peaks, widths, leftedge, rightedge)</code></pre><p>Calculate the widths of <code>peaks</code> in <code>x</code> at a reference level based on <code>proms</code> and <code>relheight</code>, removing peaks with widths less than <code>minwidth</code> or greater than <code>maxwidth</code>, if either are given. Returns the modified peaks, widths, and the left and right edges at the reference level.</p><p>Peak width is the distance between the signal crossing a reference level before and after the peak. Signal crossings are linearly interpolated between indices. The reference level is the difference between the peak height and <code>relheight</code> times the peak prominence. Width cannot be calculated for a <code>NaN</code> or <code>missing</code> prominence.</p><p>The width for a peak with a gap in the signal (e.g. <code>NaN</code>, <code>missing</code>) at the reference level will match the value/type of the signal gap if <code>strict == true</code>. For <code>strict == false</code>, the signal crossing will be linearly interpolated between the edges of the gap.</p><p>See also: <a href="@ref"><code>peakprom</code></a>, <a href="#Peaks.findminima"><code>findminima</code></a>, <a href="#Peaks.findmaxima"><code>findmaxima</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; x = [0,1,0,-1.];

julia&gt; xpks = argmaxima(x)
1-element Vector{Int64}:
 2

julia&gt; peakwidths(xpks, x, [1])
([2], [1.0], [1.5], [2.5])

julia&gt; x[3] = NaN;

julia&gt; peakwidths(xpks, x, [1])
([2], [NaN], [1.5], [NaN])

julia&gt; peakwidths(xpks, x, [1]; strict=false)
([2], [1.0], [1.5], [2.5])</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/halleysfifthinc/Peaks.jl/blob/2d6a4a25ac29e3f319adfb4e2ce1170ff5f5c655/src/peakwidth.jl#LL1-L44">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Peaks.peakwidths!" href="#Peaks.peakwidths!"><code>Peaks.peakwidths!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">peakwidths!(peaks, x, proms;
    strict=true,
    relheight=0.5,
    minwidth=nothing,
    maxwidth=nothing
) -&gt; (peaks, widths, leftedge, rightedge)</code></pre><p>Calculate the widths of <code>peaks</code> in <code>x</code> at a reference level based on <code>proms</code> and <code>relheight</code>, removing peaks with widths less than <code>minwidth</code> or greater than <code>maxwidth</code>, if either are given. Returns the modified peaks, widths, and the left and right edges at the reference level.</p><p>See also: <a href="#Peaks.peakwidths"><code>peakwidths</code></a>, <a href="#Peaks.peakproms"><code>peakproms</code></a>, <a href="#Peaks.findminima"><code>findminima</code></a>, <a href="#Peaks.findmaxima"><code>findmaxima</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/halleysfifthinc/Peaks.jl/blob/2d6a4a25ac29e3f319adfb4e2ce1170ff5f5c655/src/peakwidth.jl#LL59-L73">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Peaks.findnextmaxima" href="#Peaks.findnextmaxima"><code>Peaks.findnextmaxima</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">findnextmaxima(x, i[, w=1; strict=true])</code></pre><p>Find the index of the next maxima in <code>x</code> after or including <code>i</code>, where the maxima <code>i</code> is either the maximum of <code>x[i-w:i+w]</code> or the first index of a plateau. Returns <code>lastindex(x) + 1</code> if no maxima occur after <code>i</code>.</p><p>If <code>strict</code> is <code>true</code>, all elements in <code>x[i-w:i+w]</code> or the bounds of a plateau must exist and must not be <code>missing</code> or <code>NaN</code>. For <code>strict == false</code>, a maxima is the maximum or first element of all existing and non-NaN or missing elements in <code>x[i-w:i+w]</code> or the bounds of a plateau.</p><p>See also: <a href="#Peaks.argmaxima"><code>argmaxima</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; findnextmaxima([0,2,0,1,1,0], 2)
2

julia&gt; findnextmaxima([0,2,0,1,1,0], 3)
4
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/halleysfifthinc/Peaks.jl/blob/2d6a4a25ac29e3f319adfb4e2ce1170ff5f5c655/src/minmax.jl#LL72-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Peaks.findnextminima" href="#Peaks.findnextminima"><code>Peaks.findnextminima</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">findnextminima(x, i[, w=1, strict=true])</code></pre><p>Find the index of the next minima in <code>x</code> after or including <code>i</code>, where the minima <code>i</code> is either the minimum of <code>x[i-w:i+w]</code> or the first index of a plateau. Returns <code>lastindex(x) + 1</code> if no minima occur after <code>i</code>.</p><p>If <code>strict</code> is <code>true</code>, all elements in <code>x[i-w:i+w]</code> or the bounds of a plateau must exist and must not be <code>missing</code> or <code>NaN</code>. For <code>strict == false</code>, a minima is the minimum or first element of all existing and non-NaN or missing elements in <code>x[i-w:i+w]</code> or the bounds of a plateau.</p><p>See also: <a href="#Peaks.argminima"><code>argminima</code></a></p><p><strong>Examples</strong></p><pre><code class="language-julia-repl">julia&gt; findnextminima([3,2,3,1,1,3], 2)
2

julia&gt; findnextminima([3,2,3,1,1,3], 3)
4
</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/halleysfifthinc/Peaks.jl/blob/2d6a4a25ac29e3f319adfb4e2ce1170ff5f5c655/src/minmax.jl#LL166-L189">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Tuesday 13 July 2021 00:48">Tuesday 13 July 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
